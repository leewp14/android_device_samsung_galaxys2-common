#============= bootanim ==============
allow bootanim device:chr_file { ioctl read };

#============= bootstat ==============
allow bootstat sysfs:file read;

#============= hal_wifi_default ==============
allow hal_wifi_default sysfs:file write;

#============= healthd ==============
allow healthd sysfs:file { getattr open read };

#============= init ==============
allow init dnsproxyd_socket:sock_file write;
allow init fwmarkd_socket:sock_file write;
allow init netd:unix_stream_socket connectto;
allow init port:tcp_socket name_connect;
allow init self:tcp_socket { connect create };
allow init sysfs:file { open read write };
allow init system_data_file:fifo_file write;

#============= lmkd ==============
allow lmkd sysfs:file { open write };

#============= mediaserver ==============
allow mediaserver default_android_hwservice:hwservice_manager find;
allow mediaserver hal_camera_default:binder { call transfer };

#============= netd ==============
allow netd init:tcp_socket { getopt read setopt write };

#============= platform_app ==============
allow platform_app device:chr_file { getattr ioctl open read write };
allow platform_app sysfs:dir { open read };

#============= priv_app ==============
allow priv_app sysfs:file { getattr open read };

#============= rild ==============
allow rild device:chr_file ioctl;
allow rild system_data_file:dir { add_name write };
allow rild system_data_file:file { getattr setattr };

#============= sdcardd ==============
allow sdcardd sysfs:file { getattr open read };

#============= shell ==============
allow shell sysfs:file { getattr open read };

#============= storaged ==============
allow storaged sysfs:file { getattr open read };

#============= surfaceflinger ==============
allow surfaceflinger device:chr_file ioctl;

#============= system_server ==============
allow system_server default_android_hwservice:hwservice_manager find;
allow system_server device:chr_file ioctl;
allow system_server efs_file:dir search;
allow system_server init:binder call;
allow system_server proc:file { getattr open read };
allow system_server sensors_device:chr_file ioctl;
allow system_server unlabeled:file unlink;

#============= untrusted_app ==============
allow untrusted_app sysfs:dir { open read };
allow untrusted_app sysfs:file { getattr open read };

#============= vold_prepare_subdirs ==============
allow vold_prepare_subdirs sysfs:file { open read };
